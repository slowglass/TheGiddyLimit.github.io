"use strict";class Hist{static hashChange(a){if(Hist.isHistorySuppressed)return void Hist.setSuppressHistory(!1);const[b,...c]=Hist._getHashParts();let d=!1;if(b!==Hist.lastLoadedLink||0===c.length||a)if(Hist.lastLoadedLink=b,b===HASH_BLANK)d=!0;else{const a=Hist._getListElem(b);if(void 0===a)return"function"==typeof handleUnknownHash&&window.location.hash.length?void handleUnknownHash(b,c):void Hist._freshLoad();const d=a.attr("id");if(void 0===d)Hist._freshLoad();else{const b=a.attr("id");Hist.lastLoadedId=b,loadHash(b),document.title=decodeURIComponent(a.attr("title"))+" - 5etools"}}"function"==typeof loadSubHash&&(0<c.length||a)&&loadSubHash(c),d&&Hist._freshLoad()}static init(a){window.onhashchange=Hist.hashChange,window.location.hash.length?Hist.hashChange():Hist._freshLoad(),a&&(Hist.initialLoad=!1)}static setSuppressHistory(a){Hist.isHistorySuppressed=a}static getSelectedListElement(){const[a,...b]=Hist._getHashParts();return Hist._getListElem(a)}static getSelectedListElementWithIndex(){const[a,...b]=Hist._getHashParts();return Hist._getListElem(a,!0)}static _getHashParts(){return window.location.hash.slice(1).toLowerCase().replace(/%27/g,"'").split(HASH_PART_SEP)}static _getListElem(a,b){const c=$("#listcontainer");if(c.data("lists"))for(let d=0;d<c.data("lists").length;++d){const e=c.data("lists")[d];for(let c=0;c<e.items.length;++c){const f=e.items[c],g=$(f.elm).find(`a[id]`),h=g.get().find(b=>b.getAttribute("href").split(HASH_PART_SEP)[0]===`#${a}`);if(h)return b?{$el:$(h),x:d,y:c}:$(h)}}}static _freshLoad(){setTimeout(()=>{const a=$("#listcontainer").find(".list a").attr("href");if(a){const b=location.hash.split(HASH_PART_SEP),c=`${a}${1<b.length?`${HASH_PART_SEP}${b.slice(1).join(HASH_PART_SEP)}`:""}`;location.replace(c)}},1)}static cleanSetHash(a){window.location.hash=a.replace(/,+/g,",").replace(/,$/,"").toLowerCase()}static getHashSource(){const[a,...b]=Hist._getHashParts();return a?a.split(HASH_LIST_SEP).last():null}static getSubHash(a){const[b,...c]=Hist._getHashParts(),d=`${a}${HASH_SUB_KV_SEP}`,e=c.find(a=>a.startsWith(d));return e?e.slice(d.length):null}static setSubhash(a,b){const[c,...d]=Hist._getHashParts();c||Hist.cleanSetHash("");const e=`${a}${HASH_SUB_KV_SEP}`,f=[c];d.length&&d.filter(a=>!a.startsWith(e)).forEach(a=>f.push(a)),null!=b&&f.push(`${e}${b}`),Hist.cleanSetHash(f.join(HASH_PART_SEP))}}Hist.lastLoadedLink=null,Hist.lastLoadedId=null,Hist.initialLoad=!0,Hist.isHistorySuppressed=!1;