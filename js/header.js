"use strict";class StyleSwitcher{constructor(){this.currentStylesheet=StyleSwitcher.STYLE_DAY,this.loadStyleFromCookie()}setActiveStyleSheet(d){const a=document.documentElement.classList,b=d===StyleSwitcher.STYLE_DAY?a.remove:a.add;b.call(a,StyleSwitcher.NIGHT_CLASS),StyleSwitcher.setButtonText(d),this.currentStylesheet=d,StyleSwitcher.createCookie(this.currentStylesheet)}static setButtonText(c){const a=StyleSwitcher.getButton();a&&a.length&&a.html(`${c===StyleSwitcher.STYLE_DAY?"Night":"Day"} Mode`)}getActiveStyleSheet(){return this.currentStylesheet}loadStyleFromCookie(){this.cookie=StyleSwitcher.readCookie(),this.cookie=this.cookie?this.cookie:StyleSwitcher.getDefaultStyle(),this.setActiveStyleSheet(this.cookie)}static getButton(){return window.$?$(".nightModeToggle"):void 0}static getDefaultStyle(){return window.matchMedia("(prefers-color-scheme: dark)").matches?StyleSwitcher.STYLE_NIGHT:StyleSwitcher.STYLE_DAY}static createCookie(b){StyleSwitcher.storage.setItem(StyleSwitcher.STYLE_STORAGE,b)}static readCookie(){return StyleSwitcher.storage.getItem(StyleSwitcher.STYLE_STORAGE)}toggleActiveStyleSheet(){const b=this.currentStylesheet===StyleSwitcher.STYLE_DAY?StyleSwitcher.STYLE_NIGHT:StyleSwitcher.STYLE_DAY;this.setActiveStyleSheet(b)}}StyleSwitcher.STYLE_STORAGE="StyleSwitcher_style",StyleSwitcher.STYLE_DAY="day",StyleSwitcher.STYLE_NIGHT="night",StyleSwitcher.NIGHT_CLASS="night-mode";try{StyleSwitcher.storage=window.localStorage}catch(b){StyleSwitcher.storage={getItem(){return StyleSwitcher.STYLE_DAY},setItem(c,a){}}}const styleSwitcher=new StyleSwitcher;window.addEventListener("unload",function(){const b=styleSwitcher.getActiveStyleSheet();StyleSwitcher.createCookie(b)});;
"use strict";class NavBar{static init(){window.addEventListener("DOMContentLoaded",function(){NavBar.initElements(),NavBar.highlightCurrentPage()}),window.addEventListener("load",NavBar.initHandlers)}static initElements(){function n(a,b,c,d){d=d||{};const i=d.aHash?`#${d.aHash}`.toLowerCase():"",f=document.createElement("li");f.setAttribute("role","presentation"),f.setAttribute("id",c.toLowerCase().replace(/\s+/g,"")),f.setAttribute("data-page",`${b}${i}`),d.isRoot&&(f.classList.add("page__nav-hidden-mobile"),f.classList.add("page__btn-nav-root")),d.isSide?f.onmouseenter=function(){NavBar.handleSideItemMouseEnter(this)}:(f.onmouseenter=function(){NavBar.handleItemMouseEnter(this)},f.onclick=function(){NavBar._dropdowns.forEach(b=>b.classList.remove("open"))});const g=document.createElement("a");g.href=`${b}${i}`,g.innerHTML=c,d.isExternal&&(g.setAttribute("target","_blank"),g.classList.add("inline-split-v-center"),g.classList.add("w-100"),g.innerHTML=`<span>${c}</span><span class="glyphicon glyphicon-new-window"/>`),f.appendChild(g),a.appendChild(f)}function a(c){const a=document.createElement("li");a.setAttribute("role","presentation"),a.className="divider",c.appendChild(a)}function b(g,b,c=!1){const d=document.createElement("li");d.setAttribute("role","presentation"),d.className=`dropdown dropdown--navbar page__nav-hidden-mobile ${c?"":"page__btn-nav-root"}`,d.onmouseenter=c?function(){NavBar.handleSideItemMouseEnter(this)}:function(){NavBar.handleItemMouseEnter(this)};const e=document.createElement("a");e.className="dropdown-toggle",e.href="#",e.setAttribute("role","button"),e.onclick=function(b){NavBar.handleDropdownClick(this,b,c)},c&&(e.onmouseenter=function(){NavBar.handleSideDropdownMouseEnter(this)},e.onmouseleave=function(){NavBar.handleSideDropdownMouseLeave(this)}),e.innerHTML=`${b} <span class="caret ${c?"caret--right":""}"></span>`;const f=document.createElement("li");return f.className=`dropdown-menu ${c?"dropdown-menu--side":""}`,f.onclick=function(b){b.stopPropagation()},d.appendChild(e),d.appendChild(f),g.appendChild(d),f}function c(a,b){const c=document.createElement("li");c.setAttribute("role","presentation");const d=document.createElement("a");d.href="#",b.className&&(d.className=b.className),d.onclick=b.click,d.innerHTML=b.html,b.title&&c.setAttribute("title",b.title),c.appendChild(d),a.appendChild(c)}const d=document.getElementById("navbar"),e=document.createElement("button");e.className="btn btn-default page__btn-toggle-nav",e.innerHTML="Menu",e.onclick=()=>{$(e).toggleClass("active"),$(`.page__nav-hidden-mobile`).toggleClass("block",$(e).hasClass("active"))},document.getElementById("navigation").prepend(e),n(d,"5etools.html","Home",{isRoot:!0});const f=b(d,"Rules");n(f,"quickreference.html","Quick Reference"),n(f,"variantrules.html","Variant & Optional Rules/Misc"),n(f,"tables.html","Tables"),a(f),n(f,"book.html","Dungeon Master's Guide",{aHash:"DMG"}),n(f,"book.html","Monster Manual",{aHash:"MM"}),n(f,"book.html","Player's Handbook",{aHash:"PHB"}),a(f),n(f,"book.html","Acquisitions Incorporated",{aHash:"AI"}),n(f,"book.html","Guildmasters' Guide to Ravnica",{aHash:"GGR"}),n(f,"book.html","Mordenkainen's Tome of Foes",{aHash:"MTF"}),n(f,"book.html","Sword Coast Adventurer's Guide",{aHash:"SCAG"}),n(f,"book.html","Volo's Guide to Monsters",{aHash:"VGM"}),n(f,"book.html","Xanathar's Guide to Everything",{aHash:"XGE"}),a(f),n(f,"book.html","Adventurers League",{aHash:"AL"}),a(f),n(f,"books.html","View All/Homebrew");const g=b(d,"Player Options");n(g,"classes.html","Classes"),n(g,"backgrounds.html","Backgrounds"),n(g,"feats.html","Feats"),n(g,"races.html","Races"),a(g),n(g,"statgen.html","Statgen"),a(g),n(g,"lifegen.html","This Is Your Life"),n(g,"names.html","Names");const h=b(d,"DM Tools");n(h,"dmscreen.html","DM Screen"),a(h);const i=b(h,"Adventures",!0);n(i,"adventure.html","Lost Mines of Phandelver",{isSide:!0,aHash:"LMoP"}),n(i,"adventure.html","Hoard of the Dragon Queen",{isSide:!0,aHash:"HotDQ"}),n(i,"adventure.html","Rise of Tiamat",{isSide:!0,aHash:"RoT"}),n(i,"adventure.html","Princes of the Apocalypse",{isSide:!0,aHash:"PotA"}),n(i,"adventure.html","Out of the Abyss",{isSide:!0,aHash:"OotA"}),n(i,"adventure.html","Curse of Strahd",{isSide:!0,aHash:"CoS"}),n(i,"adventure.html","Storm King's Thunder",{isSide:!0,aHash:"SKT"}),n(i,"adventure.html","Tales from the Yawning Portal: The Sunless Citadel",{isSide:!0,aHash:"TftYP-TSC"}),n(i,"adventure.html","Tales from the Yawning Portal: The Forge of Fury",{isSide:!0,aHash:"TftYP-TFoF"}),n(i,"adventure.html","Tales from the Yawning Portal: The Hidden Shrine of Tamoachan",{isSide:!0,aHash:"TftYP-THSoT"}),n(i,"adventure.html","Tales from the Yawning Portal: White Plume Mountain",{isSide:!0,aHash:"TftYP-WPM"}),n(i,"adventure.html","Tales from the Yawning Portal: Dead in Thay",{isSide:!0,aHash:"TftYP-DiT"}),n(i,"adventure.html","Tales from the Yawning Portal: Against the Giants",{isSide:!0,aHash:"TftYP-AtG"}),n(i,"adventure.html","Tales from the Yawning Portal: Tomb of Horrors",{isSide:!0,aHash:"TftYP-ToH"}),n(i,"adventure.html","Tomb of Annihilation",{isSide:!0,aHash:"ToA"}),n(i,"adventure.html","The Tortle Package",{isSide:!0,aHash:"TTP"}),n(i,"adventure.html","Waterdeep: Dragon Heist",{isSide:!0,aHash:"WDH"}),n(i,"adventure.html","Lost Laboratory of Kwalish",{isSide:!0,aHash:"LLK"}),n(i,"adventure.html","Waterdeep: Dungeon of the Mad Mage",{isSide:!0,aHash:"WDMM"}),n(i,"adventure.html","Krenko's Way",{isSide:!0,aHash:"KKW"}),n(i,"adventure.html","Ghosts of Saltmarsh",{isSide:!0,aHash:"GoS"}),n(i,"adventure.html","Hunt for the Thessalhydra",{isSide:!0,aHash:"HftT"}),n(i,"adventure.html","The Orrery of the Wanderer",{isSide:!0,aHash:"OoW"}),n(i,"adventure.html","Dragon of Icespire Peak",{isSide:!0,aHash:"DIP"}),a(i),n(i,"adventures.html","View All/Homebrew"),n(h,"cultsboons.html","Cults & Demonic Boons"),n(h,"objects.html","Objects"),n(h,"trapshazards.html","Traps & Hazards"),a(h),n(h,"crcalculator.html","CR Calculator"),n(h,"encountergen.html","Encounter Generator"),n(h,"lootgen.html","Loot Generator");const j=b(d,"References");n(j,"bestiary.html","Bestiary"),n(j,"conditionsdiseases.html","Conditions & Diseases"),n(j,"deities.html","Deities"),n(j,"items.html","Items"),n(j,"optionalfeatures.html","Other Options and Features"),n(j,"rewards.html","Other Rewards"),n(j,"psionics.html","Psionics"),n(j,"spells.html","Spells"),n(j,"vehicles.html","Vehicles");const k=b(d,"Utilities");n(k,"blacklist.html","Content Blacklist"),n(k,"managebrew.html","Homebrew Manager"),n(k,"inittrackerplayerview.html","Initiative Tracker Player View"),a(k),n(k,"makebrew.html","Homebrew Builder"),n(k,"demo.html","Renderer Demo"),n(k,"converter.html","Text Converter"),a(k),n(k,"roll20.html","Roll20 Script Help"),n(k,"makeshaped.html","Roll20 Shaped Sheet JS Builder"),a(k),n(k,"changelog.html","Changelog"),n(k,`https://wiki.5e.tools/index.php/Page:_${NavBar.getCurrentPage().replace(/.html$/i,"")}`,"Help",{isExternal:!0}),a(k),n(k,"privacy-policy.html","Privacy Policy"),n(d,"donate.html","Donate",{isRoot:!0});const l=b(d,"Settings");c(l,{html:styleSwitcher.getActiveStyleSheet()===StyleSwitcher.STYLE_DAY?"Night Mode":"Day Mode",click:b=>{b.preventDefault(),styleSwitcher.toggleActiveStyleSheet()},className:"nightModeToggle"}),c(l,{html:"Save State to File",click:async d=>{d.preventDefault();const a=StorageUtil.syncGetDump(),b=await StorageUtil.pGetDump();DataUtil.userDownload("5etools",{sync:a,async:b})},title:"Save any locally-stored data (loaded homebrew, active blacklists, DM Screen configuration,...) to a file."}),c(l,{html:"Load State from File",click:async c=>{c.preventDefault();const a=await DataUtil.pUserUpload();StorageUtil.syncSetFromDump(a.sync),await StorageUtil.pSetFromDump(a.async),location.reload()},title:"Load previously-saved data (loaded homebrew, active blacklists, DM Screen configuration,...) from a file."})}static getCurrentPage(){let b=window.location.pathname;return b=b.substr(b.lastIndexOf("/")+1),b||(b="5etools.html"),b.trim()}static highlightCurrentPage(){let f=NavBar.getCurrentPage(),g=!1;if("book.html"===f.toLowerCase()||"adventure.html"===f.toLowerCase()){const a=window.location.hash.split(",")[0];"adventure.html"===f.toLowerCase()&&(g=!0),f+=a.toLowerCase()}"adventures.html"===f.toLowerCase()&&(g=!0);try{let a=document.querySelector(`li[data-page="${f}"]`);null==a&&(f=f.split("#")[0],NavBar.ALT_CHILD_PAGES[f]&&(f=NavBar.ALT_CHILD_PAGES[f]),a=document.querySelector(`li[data-page="${f}"]`)),a.parentNode.childNodes.forEach(b=>b.classList&&b.classList.remove("active")),a.classList.add("active");let b=a.parentNode;const c=()=>{for(;null!==b&&("LI"!==b.nodeName||!b.classList.contains("dropdown"));)b=b.parentNode;b&&b.classList.add("active")};c(),g&&(b=b.parentNode,c())}catch(b){setTimeout(()=>{throw b})}}static initHandlers(){NavBar._dropdowns=[...document.getElementById("navbar").querySelectorAll(`li.dropdown--navbar`)],document.addEventListener("click",()=>NavBar._dropdowns.forEach(b=>b.classList.remove("open"))),document.addEventListener("mousemove",b=>{NavBar._mouseX=b.clientX,NavBar._mouseY=b.clientY}),NavBar._clearAllTimers()}static handleDropdownClick(d,a,b){if(a.preventDefault(),a.stopPropagation(),!b){const a=d.parentNode.classList.contains("open");a?NavBar._dropdowns.forEach(b=>b.classList.remove("open")):NavBar._openDropdown(d)}}static _openDropdown(d){const e=new Set;let a=d.parentNode;for(a.classList.add("open"),e.add(a);"NAV"!==a.nodeName;)a=a.parentNode,"LI"===a.nodeName&&(a.classList.add("open"),e.add(a));NavBar._dropdowns.filter(b=>!e.has(b)).forEach(b=>b.classList.remove("open"))}static handleItemMouseEnter(d){const a=$(d),b=a.siblings("[data-timer-id]").map((c,a)=>({$ele:$(a),timerId:$(a).data("timer-id")})).get();b.forEach(({$ele:f,timerId:a})=>{if(NavBar._timersOpen[a]&&(clearTimeout(NavBar._timersOpen[a]),delete NavBar._timersOpen[a]),!NavBar._timersClose[a]&&f.hasClass("open")){const b=()=>{if(NavBar._timerMousePos[a]){const[c,d]=NavBar._timerMousePos[a];NavBar._mouseX>c+NavBar.MIN_MOVE_PX?(NavBar._timerMousePos[a]=[NavBar._mouseX,NavBar._mouseY],NavBar._timersClose[a]=setTimeout(()=>b(),NavBar.DROP_TIME/2)):(f.removeClass("open"),delete NavBar._timersClose[a])}else f.removeClass("open"),delete NavBar._timersClose[a]};NavBar._timersClose[a]=setTimeout(()=>b(),NavBar.DROP_TIME)}})}static handleSideItemMouseEnter(c){const a=$(c).closest(`li.dropdown`).data("timer-id");NavBar._timersClose[a]&&(clearTimeout(NavBar._timersClose[a]),delete NavBar._timersClose[a],delete NavBar._timerMousePos[a])}static handleSideDropdownMouseEnter(d){const a=$(d),b=a.parent().data("timer-id")||NavBar._timerId++;a.parent().attr("data-timer-id",b),NavBar._timersClose[b]&&(clearTimeout(NavBar._timersClose[b]),delete NavBar._timersClose[b]),NavBar._timersOpen[b]||(NavBar._timersOpen[b]=setTimeout(()=>{NavBar._openDropdown(d),delete NavBar._timersOpen[b],NavBar._timerMousePos[b]=[NavBar._mouseX,NavBar._mouseY]},NavBar.DROP_TIME))}static handleSideDropdownMouseLeave(c){const d=$(c);if(d.parent().data("timer-id")){const b=d.parent().data("timer-id");clearTimeout(NavBar._timersOpen[b]),delete NavBar._timersOpen[b]}}static _clearAllTimers(){Object.entries(NavBar._timersOpen).forEach(([c,a])=>{clearTimeout(a),delete NavBar._timersOpen[c]})}}NavBar.DROP_TIME=250,NavBar.MIN_MOVE_PX=7,NavBar.ALT_CHILD_PAGES={"book.html":"books.html","adventure.html":"adventures.html"},NavBar._timerId=1,NavBar._timersOpen={},NavBar._timersClose={},NavBar._timerMousePos={},NavBar._mouseX=null,NavBar._mouseY=null,NavBar.init();;
"use strict";window.addEventListener("load",()=>{if("function"!=typeof[].flat){const d=$(`body`);d.addClass("edge__body");const a=$(`<button class="btn btn-danger edge__btn-close"><span class="glyphicon glyphicon-remove"/></button>`).click(()=>{b.remove(),d.removeClass("edge__body")}),b=$(`<div class="flex-col flex-vh-center relative edge__overlay"/>`);a.appendTo(b),b.append(`<div class="flex-col flex-vh-center">
			<div class="edge__title mb-2">UPDATE YOUR BROWSER</div>
			<div><i>It looks like you're using an outdated browser.<br>
			5etools recommends and supports the latest <a href="https://www.google.com/chrome/" class="edge__link">Chrome</a> and the latest <a href="https://www.mozilla.org/firefox/" class="edge__link">Firefox</a>.</i></div>
		</div>`).appendTo(d)}});